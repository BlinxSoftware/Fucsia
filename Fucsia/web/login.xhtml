<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:ui="http://java.sun.com/jsf/facelets"
       xmlns:h="http://java.sun.com/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:f="http://java.sun.com/jsf/core"
       xmlns:pm="http://primefaces.org/mobile">

    <h:head>
        <title>Fucsia</title>
        <link href="./styles/LoginStyles.css" rel="stylesheet"/> 
        <script language="JavaScript">
            var device = navigator.userAgent;
            if (device.match(/Iphone/i) || device.match(/Ipod/i) || device.match(/Android/i) || device.match(/J2ME/i) || device.match(/BlackBerry/i) || device.match(/iPhone|iPad|iPod/i) || device.match(/Opera Mini/i) || device.match(/IEMobile/i) || device.match(/Mobile/i) || device.match(/Windows Phone/i) || device.match(/windows mobile/i) || device.match(/windows ce/i) || device.match(/webOS/i) || device.match(/palm/i) || device.match(/bada/i) || device.match(/series60/i) || device.match(/nokia/i) || device.match(/symbian/i) || device.match(/HTC/i))
            {
                window.location = "/Fucsia/faces/loginM.xhtml";
            }
        </script>
    </h:head>

    <h:body>
        <div id="container">
            <img src="images/dialogo.png" id="dialogo"/>
            <h:form id="frmlogin" >
                <p:growl id="growl"   sticky="false"  life="80000" />
                <div id="insideForm">
                    <p:inputText value="#{usuarioBean.userName}" class="general" placeholder="Usuario"/>
                    <br/>
                    <br/>
                    <p:password value="#{usuarioBean.password}" class="general" placeholder="ContraseÃ±a"/>
                    <br/>
                    <br/>
                    <p:commandButton value="Login" class="general generalButton" actionListener="#{usuarioBean.login(actionEvent)}"  update="growl" oncomplete="handleLoginRequest(xhr, status, args)"/>
                    <br/>
                    <br/>
                    <p:commandButton value="Crear usuario" class="general generalButton" action="newUser" actionListener="#{usuarioBean.resetEstado()}"/>
                </div>
                <p:commandButton id="setImg" actionListener="#{usuarioBean.setiarImagen(actionEvent)}" style="display: none"/>
            </h:form>  
        </div>

        <script type="text/javascript">
            function handleLoginRequest(xhr, status, args) {
                if (args.validationFailed || !args.loggedIn) {
                } else {
                    if (args.admin) {
                        window.location = "/Fucsia/faces/users.xhtml";
                    } else {
                        window.location = "/Fucsia/faces/usersView.xhtml";
                         document.getElementById('frmlogin:setImg').click();
                    }

                }
            }
        </script>  
    </h:body>

</html>

